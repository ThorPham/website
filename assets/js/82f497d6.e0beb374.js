"use strict";(self.webpackChunkneo_dev_portal=self.webpackChunkneo_dev_portal||[]).push([[5475],{3905:function(e,n,t){t.d(n,{Zo:function(){return u},kt:function(){return k}});var r=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=r.createContext({}),c=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},u=function(e){var n=c(e.components);return r.createElement(l.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),d=c(t),k=o,m=d["".concat(l,".").concat(k)]||d[k]||p[k]||a;return t?r.createElement(m,s(s({ref:n},u),{},{components:t})):r.createElement(m,s({ref:n},u))}));function k(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,s=new Array(a);s[0]=d;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i.mdxType="string"==typeof e?e:o,s[1]=i;for(var c=2;c<a;c++)s[c]=t[c];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},58215:function(e,n,t){var r=t(67294);n.Z=function(e){var n=e.children,t=e.hidden,o=e.className;return r.createElement("div",{role:"tabpanel",hidden:t,className:o},n)}},55064:function(e,n,t){t.d(n,{Z:function(){return c}});var r=t(67294),o=t(79443);var a=function(){var e=(0,r.useContext)(o.Z);if(null==e)throw new Error('"useUserPreferencesContext" is used outside of "Layout" component.');return e},s=t(86010),i="tabItem_1uMI",l="tabItemActive_2DSg";var c=function(e){var n,t=e.lazy,o=e.block,c=e.defaultValue,u=e.values,p=e.groupId,d=e.className,k=r.Children.toArray(e.children),m=null!=u?u:k.map((function(e){return{value:e.props.value,label:e.props.label}})),f=null!=c?c:null==(n=k.find((function(e){return e.props.default})))?void 0:n.props.value,h=a(),b=h.tabGroupChoices,v=h.setTabGroupChoices,g=(0,r.useState)(f),y=g[0],w=g[1],N=[];if(null!=p){var T=b[p];null!=T&&T!==y&&m.some((function(e){return e.value===T}))&&w(T)}var C=function(e){var n=e.currentTarget,t=N.indexOf(n),r=m[t].value;w(r),null!=p&&(v(p,r),setTimeout((function(){var e,t,r,o,a,s,i,c;(e=n.getBoundingClientRect(),t=e.top,r=e.left,o=e.bottom,a=e.right,s=window,i=s.innerHeight,c=s.innerWidth,t>=0&&a<=c&&o<=i&&r>=0)||(n.scrollIntoView({block:"center",behavior:"smooth"}),n.classList.add(l),setTimeout((function(){return n.classList.remove(l)}),2e3))}),150))},x=function(e){var n,t=null;switch(e.key){case"ArrowRight":var r=N.indexOf(e.target)+1;t=N[r]||N[0];break;case"ArrowLeft":var o=N.indexOf(e.target)-1;t=N[o]||N[N.length-1]}null==(n=t)||n.focus()};return r.createElement("div",{className:"tabs-container"},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.Z)("tabs",{"tabs--block":o},d)},m.map((function(e){var n=e.value,t=e.label;return r.createElement("li",{role:"tab",tabIndex:y===n?0:-1,"aria-selected":y===n,className:(0,s.Z)("tabs__item",i,{"tabs__item--active":y===n}),key:n,ref:function(e){return N.push(e)},onKeyDown:x,onFocus:C,onClick:C},null!=t?t:n)}))),t?(0,r.cloneElement)(k.filter((function(e){return e.props.value===y}))[0],{className:"margin-vert--md"}):r.createElement("div",{className:"margin-vert--md"},k.map((function(e,n){return(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==y})}))))}},82924:function(e,n,t){var r=t(67294).createContext(void 0);n.Z=r},79443:function(e,n,t){var r=(0,t(67294).createContext)(void 0);n.Z=r},85350:function(e,n,t){var r=t(67294),o=t(82924);n.Z=function(){var e=(0,r.useContext)(o.Z);if(null==e)throw new Error('"useThemeContext" is used outside of "Layout" component. Please see https://docusaurus.io/docs/api/themes/configuration#usethemecontext.');return e}},74914:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return i},contentTitle:function(){return l},metadata:function(){return c},toc:function(){return u},default:function(){return d}});var r=t(87462),o=t(63366),a=(t(67294),t(3905)),s=(t(16213),t(55064),t(58215),["components"]),i={title:"Tokens",date:new Date("2022-01-18T21:13:48.000Z")},l=void 0,c={unversionedId:"n3/Advances/neofs/topics/tokens",id:"n3/Advances/neofs/topics/tokens",isDocsHomePage:!1,title:"Tokens",description:"Tokens are required to act on any objects within a container. Sessions last for limited time and are restricted by permissions. Session tokens use the private key to sign them while bearer tokens are issued to wallets by a container owner.",source:"@site/docs/n3/Advances/neofs/topics/tokens.mdx",sourceDirName:"n3/Advances/neofs/topics",slug:"/n3/Advances/neofs/topics/tokens",permalink:"/website/docs/n3/Advances/neofs/topics/tokens",editUrl:"https://github.com/neo-project/neo-dev-portal/blob/master/docs/n3/Advances/neofs/topics/tokens.mdx",tags:[],version:"current",lastUpdatedBy:"Celia18305",frontMatter:{title:"Tokens",date:"2022-01-18T21:13:48.000Z"},sidebar:"docs",previous:{title:"Policies",permalink:"/website/docs/n3/Advances/neofs/topics/policies"},next:{title:"Wallets",permalink:"/website/docs/n3/Advances/neofs/topics/wallets"}},u=[{value:"Session Tokens",id:"session-tokens",children:[{value:"Creating a session token",id:"creating-a-session-token",children:[]},{value:"Libraries",id:"libraries",children:[]}]},{value:"Bearer Tokens",id:"bearer-tokens",children:[{value:"Using a Bearer Token",id:"using-a-bearer-token",children:[]}]}],p={toc:u};function d(e){var n=e.components,t=(0,o.Z)(e,s);return(0,a.kt)("wrapper",(0,r.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Tokens are required to act on any ",(0,a.kt)("a",{parentName:"p",href:"/docs/n3/neofs/topics/objects"},"objects")," within a ",(0,a.kt)("a",{parentName:"p",href:"/docs/n3/neofs/topics/containers"},"container"),". Sessions last for limited time and are restricted by permissions. ",(0,a.kt)("a",{parentName:"p",href:"/docs/n3/neofs/topics/tokens"},"Session tokens")," use the private key to sign them while ",(0,a.kt)("a",{parentName:"p",href:"/examples/tokens"},"bearer tokens")," are issued to wallets by a container owner."),(0,a.kt)("h2",{id:"session-tokens"},"Session Tokens"),(0,a.kt)("p",null,"Session tokens are tokens that are generated from your private key and are required to access or interact with content inside a container. These tokens should only be used by container owners and not distributed to third parties"),(0,a.kt)("h3",{id:"creating-a-session-token"},"Creating a session token"),(0,a.kt)("p",null,"You will need"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"to decide how long the token should last (e.g ",(0,a.kt)("inlineCode",{parentName:"li"},"const DEFAULT_EXPIRATION = 140000"),")"),(0,a.kt)("li",{parentName:"ol"},"a context (generally you can use ",(0,a.kt)("inlineCode",{parentName:"li"},"context.Background()"),") but this depends on your usecase"),(0,a.kt)("li",{parentName:"ol"},"A ",(0,a.kt)("a",{parentName:"li",href:"/docs/n3/neofs/topics/clients"},"NeoFS client")),(0,a.kt)("li",{parentName:"ol"},"have access to a private key. This is retrieved from a json file using the ",(0,a.kt)("a",{parentName:"li",href:"/docs/n3/neofs/topics/helpers/#get-credentials-from-path"},"helper function")," ",(0,a.kt)("inlineCode",{parentName:"li"},"helper.GetCredentialsFromPath")," (",(0,a.kt)("inlineCode",{parentName:"li"},"key"),")")),(0,a.kt)("h3",{id:"libraries"},"Libraries"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'    "github.com/nspcc-dev/neofs-sdk-go/session"\n    "github.com/nspcc-dev/neofs-sdk-go/token"\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},"var prmSessionCreate client.PrmSessionCreate\n\nprmSessionCreate.SetExp(expiry)\n\nres, err := cli.SessionCreate(ctx, prmSessionCreate)\nif err != nil {\n    return &session.Token{}, err\n}\naddr := address.NewAddress()\naddr.SetContainerID(&containerID)\n\n\ncntContext := session.NewContainerContext()\ncntContext.IsForDelete()\ncntContext.ApplyTo(&containerID)\n\nobjectCtx := session.NewObjectContext()\nobjectCtx.ForPut()\nobjectCtx.ApplyTo(addr)\n\nstoken := session.NewToken()\nstoken.SetSessionKey(res.PublicKey())\nstoken.SetID(res.ID())\nstoken.SetExp(expiry)\nstoken.SetOwnerID(owner)\nstoken.SetContext(cntContext)\n\nerr = stoken.Sign(key)\n")),(0,a.kt)("p",null,"Session tokens are all that is required for the owner, or the account with the private key that created the container, to access the container. The owner is the most privileged account with regards to a container so a session key should never be shared."),(0,a.kt)("h2",{id:"bearer-tokens"},"Bearer Tokens"),(0,a.kt)("p",null,"Bearer tokens allow the account that owns the container, to issue limited time access tokens to other accounts. Bearer tokens require rules to be applied to grant access and to deny access to anyone else. Read more about ",(0,a.kt)("a",{parentName:"p",href:"/docs/n3/neofs/topics/acl-permissions"},"EACL Tables")," to get a better understanding of what they are"),(0,a.kt)("p",null,"Once an account has a bearer token it can pass the token along with any request to the container as it does a Session Token."),(0,a.kt)("p",null,"You will need"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"A ",(0,a.kt)("a",{parentName:"li",href:"/docs/n3/neofs/topics/clients"},"NeoFS client")),(0,a.kt)("li",{parentName:"ol"},"A context (",(0,a.kt)("inlineCode",{parentName:"li"},"context.Background")," is fine in most cicumstances)"),(0,a.kt)("li",{parentName:"ol"},"When you want the bearer token to expire, in epochs. See helpers for a basic estimation"),(0,a.kt)("li",{parentName:"ol"},"The ownerID of the intended account (see helpers) (",(0,a.kt)("inlineCode",{parentName:"li"},"tokenReceiverOwnerID"),")"),(0,a.kt)("li",{parentName:"ol"},"An ",(0,a.kt)("a",{parentName:"li",href:"/docs/n3/neofs/topics/ecl-permissions"},"EACL table")),(0,a.kt)("li",{parentName:"ol"},"The container owner's private key (",(0,a.kt)("inlineCode",{parentName:"li"},"containerOwnerPrivateKey"),")")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},"btoken :=  token.NewBearerToken()\nbtoken.SetLifetime(expire, 0, 0)\nbtoken.SetOwner(tokenReceiver)\nbtoken.SetEACLTable(eaclTable)\nerr := btoken.SignToken(containerOwnerKey)\nreturn btoken, err\n\n// Marshal and provide it to bearer token user\njsonData, err := btoken.MarshalJSON()\nreturn jsonData, er\n")),(0,a.kt)("p",null,"You can then send this to the intended recipient who can then use it"),(0,a.kt)("h3",{id:"using-a-bearer-token"},"Using a Bearer Token"),(0,a.kt)("p",null,"To use a bearer token first you must convert it back into the ",(0,a.kt)("inlineCode",{parentName:"p"},"BearerToken")," type."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},"btoken := new(token.BearerToken)\nerr := btoken.UnmarshalJSON(jsonData)\nif err != nil {\n    return btoken, err\n}\n//this is your bearer token you can now use\nreturn btoken, err\n")),(0,a.kt)("p",null,"See Objects for further examples, but you can now attach Bearer Tokens to requests to NeoFS. "),(0,a.kt)("p",null,"The recipient of the Bearer Token now provides both the bearer token and a generated session token as required. "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},"objWriter, err := cli.ObjectPutInit(ctx, client.PrmObjectPutInit{})\nif sessionToken != nil {\n    objWriter.WithinSession(*sessionToken)\n}\nif bearerToken != nil {\n    objWriter.WithBearerToken(*bearerToken)\n}\n")),(0,a.kt)("p",null,"In the examples on the objects page, there is no bearer token provided. This is because the client functions are expecting a variable length input, so just providing a Session Token is fine, you can also provide ",(0,a.kt)("inlineCode",{parentName:"p"},"nil")," as the Bearer Token if you prefer"))}d.isMDXComponent=!0}}]);