"use strict";(self.webpackChunkneo_dev_portal=self.webpackChunkneo_dev_portal||[]).push([[4750],{3905:function(e,t,a){a.d(t,{Zo:function(){return d},kt:function(){return u}});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=n.createContext({}),c=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},d=function(e){var t=c(e.components);return n.createElement(p.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),m=c(a),u=r,F=m["".concat(p,".").concat(u)]||m[u]||s[u]||i;return a?n.createElement(F,l(l({ref:t},d),{},{components:a})):n.createElement(F,l({ref:t},d))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,l=new Array(i);l[0]=m;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var c=2;c<i;c++)l[c]=a[c];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},44687:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return o},contentTitle:function(){return p},metadata:function(){return c},toc:function(){return d},default:function(){return m}});var n=a(87462),r=a(63366),i=(a(67294),a(3905)),l=["components"],o={},p="Encryption Algorithm",c={unversionedId:"n3/foundation/Cryptography/encryption_algorithm",id:"n3/foundation/Cryptography/encryption_algorithm",isDocsHomePage:!1,title:"Encryption Algorithm",description:"ECC Algorithm",source:"@site/docs/n3/foundation/Cryptography/encryption_algorithm.md",sourceDirName:"n3/foundation/Cryptography",slug:"/n3/foundation/Cryptography/encryption_algorithm",permalink:"/website/docs/n3/foundation/Cryptography/encryption_algorithm",editUrl:"https://github.com/neo-project/neo-dev-portal/blob/master/docs/n3/foundation/Cryptography/encryption_algorithm.md",tags:[],version:"current",lastUpdatedBy:"Apisit Toompkadee",frontMatter:{},sidebar:"docs",previous:{title:"Encoding Algorithm",permalink:"/website/docs/n3/foundation/Cryptography/encode_algorithm"},next:{title:"Hash Algorithm",permalink:"/website/docs/n3/foundation/Cryptography/hash_algorithm"}},d=[{value:"ECC Algorithm",id:"ecc-algorithm",children:[]},{value:"ECDSA signing",id:"ecdsa-signing",children:[]},{value:"AES Encryption",id:"aes-encryption",children:[]}],s={toc:d};function m(e){var t=e.components,o=(0,r.Z)(e,l);return(0,i.kt)("wrapper",(0,n.Z)({},s,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"encryption-algorithm"},"Encryption Algorithm"),(0,i.kt)("h2",{id:"ecc-algorithm"},"ECC Algorithm"),(0,i.kt)("p",null,"Elliptic Curve Cryptography (ECC) algorithm is a kind of asymmetric encryption algorithm. With the irreversible feature of K=k","*","G process (K: public key, G: base point (constant)), it can prevent solving private key from public key by brutal force. With the same length of secret key, ECC has higher security level and saves computing resource compared to other encryption algorithms such as RSA. ECC combined with other algorithms, is widely used in signing fields, i.e. ECDSA digital signature."),(0,i.kt)("p",null,"Same as Bitcoin, Neo adopts ECC as public key generating algorithm. Neo defines a special secp256r1-standard elliptic curve with parameters:"),(0,i.kt)("p",null,"Prime Q: 00FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF"),(0,i.kt)("p",null,"Parameter A: 00FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC"),(0,i.kt)("p",null,"Parameter B: 005AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B"),(0,i.kt)("p",null,"Order N: 00FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551"),(0,i.kt)("p",null,"Base Point G: (0x6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296,\u3000\u30000x4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5)"),(0,i.kt)("p",null,"In addition, to support the cross-chain transaction verification, Neo introduces the SECP256K1 curve with parameters\uff1a"),(0,i.kt)("p",null,"Prime Q: 00FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F"),(0,i.kt)("p",null,"Parameter A: 0"),(0,i.kt)("p",null,"Parameter B: 7"),(0,i.kt)("p",null,"Order N: 00FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141"),(0,i.kt)("p",null,'Base Point G: ("04" + "79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798" + "483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8")'),(0,i.kt)("p",null,"Example:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Name"),(0,i.kt)("th",{parentName:"tr",align:null},"Value"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"private key"),(0,i.kt)("td",{parentName:"tr",align:null},"c7134d6fd8e73d819e82755c64c93788d8db0961929e025a53363c4cc02a6962")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"public key (compressed)"),(0,i.kt)("td",{parentName:"tr",align:null},"035a928f201639204e06b4368b1a93365462a8ebbff0b8818151b74faab3a2b61a")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"public key (uncompressed)"),(0,i.kt)("td",{parentName:"tr",align:null},"045a928f201639204e06b4368b1a93365462a8ebbff0b8818151b74faab3a2b61a 35dfabcb79ac492a2a88588d2f2e73f045cd8af58059282e09d693dc340e113f")))),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Uncompressed public key above is in single line."))),(0,i.kt)("p",null,"Scenarios:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Generating public key with private key")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Signing and signature verification"))),(0,i.kt)("p",null,"For more information, refer to ",(0,i.kt)("a",{parentName:"p",href:"https://arstechnica.com/information-technology/2013/10/a-relatively-easy-to-understand-primer-on-elliptic-curve-cryptography/"},"A relatively easy to understand primer on elliptic curve cryptography"),"."),(0,i.kt)("h2",{id:"ecdsa-signing"},"ECDSA signing"),(0,i.kt)("p",null,"Elliptic Curve Digital Signature Algorithm (ECDSA) is a simulation of Digital Signature Algorithm (DSA) by ECC algorithm. Its advantage includes fast speed, reliable strength and short signature."),(0,i.kt)("p",null,"Brief steps are as follows:"),(0,i.kt)("p",null,"Assume private key, public key and base point as k, K and G, respectively. We know that K = k","*","G according to ECC algorithm."),(0,i.kt)("p",null,"Signing procedure:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select random number r and compute point r\xb7G(x, y).")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Compute s = (h + k\xb7x)/r according to random number r, message M's hash value h, private key k.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Send message M and signature {r\xb7G, s} to receiver."))),(0,i.kt)("p",null,"Verification procedure:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Receiver receives message M and signature {r\xb7G=(x,y), s}.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Compute hash h according to received message.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Compute h\xb7G/s + x\xb7K/s with sender public key K and compare with r\xb7G. Verification succeeds if both are the same."))),(0,i.kt)("p",null,"Deduction is as follows:"),(0,i.kt)("p",null,(0,i.kt)("a",{target:"_blank",href:a(86364).Z},(0,i.kt)("img",{alt:"formula_ecdsa",src:a(3030).Z}))),(0,i.kt)("p",null,"Example:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Name"),(0,i.kt)("th",{parentName:"tr",align:null},"Value"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Message"),(0,i.kt)("td",{parentName:"tr",align:null},"Hello World")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Private Key"),(0,i.kt)("td",{parentName:"tr",align:null},"f9be359876aac462df9ec642e5d063140daedb83aefc0f8657b08132d3da62d2")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Public Key"),(0,i.kt)("td",{parentName:"tr",align:null},"04ed08d3bc46390a54350d841c8110ca02f9e357f8ba08702078de2d7041727",(0,i.kt)("br",null),"5956e94045d041a2bf89be25d5a56ddcf15c4f629d5a1db32657d0da13ebde64b29")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Signature"),(0,i.kt)("td",{parentName:"tr",align:null},"54a6faec9159e98d45f5868e5799762de290c3e7e67e013c1bd6a2a6f8a2e500",(0,i.kt)("br",null),"a4d29567359bd171ddebc547dcddd670fb6b367e3e19298d7672f0422b5a2c52")))),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"public key and signature above are both in a single line."))),(0,i.kt)("p",null,"Scenarios\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Transaction signature.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Consensus."))),(0,i.kt)("h2",{id:"aes-encryption"},"AES Encryption"),(0,i.kt)("p",null,"Advanced Encryption Standard (AES) is a kind of block cipher algorithm in symmetric encryption algorithms. Its block size can be 128, 192, 256. AES has the following advantages: (1) fast processing speed, (2) whole process can be described in math, (3) currently no effective cracking method."),(0,i.kt)("p",null,"Neo uses 256-bit AES encryption algorithm, where encryption mode is ECB and filling method is NoPadding."),(0,i.kt)("p",null,"Example\uff1a"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"msg,key-----\x3epassphrase-protected msg")),(0,i.kt)("p",null,'\u3000\u3000(Message: 256-bit hash of "Hello World") + (password: 256-bit hash of "l love coding")'),(0,i.kt)("p",null,'\u3000\u3000="a591a6d40bf420404a011733cfb7b190d62c65bf0bcda32b57b277d9ad9f146e"'),(0,i.kt)("p",null,'\u3000\u3000\u3000+"da04fe4405fc021e4ca5ca956b263828e99d4ce2a342b2cbdc919baddbe178ae"'),(0,i.kt)("p",null,'\u3000\u3000----\x3e"a8158a64c1e9d776e12582d8c63553ee0c7687bd8e374f79c766e7459577f547"'),(0,i.kt)("ol",{start:2},(0,i.kt)("li",{parentName:"ol"},"passphrase-protected msg,key-----\x3emsg")),(0,i.kt)("p",null,'\u3000\u3000Ciphertext + (password: 256-bit hash of "l love coding")'),(0,i.kt)("p",null,'\u3000\u3000="a8158a64c1e9d776e12582d8c63553ee0c7687bd8e374f79c766e7459577f547"'),(0,i.kt)("p",null,'\u3000\u3000\u3000+"da04fe4405fc021e4ca5ca956b263828e99d4ce2a342b2cbdc919baddbe178ae"'),(0,i.kt)("p",null,'\u3000\u3000----\x3e"a591a6d40bf420404a011733cfb7b190d62c65bf0bcda32b57b277d9ad9f146e"'),(0,i.kt)("p",null,"Scenarios\uff1a"),(0,i.kt)("p",null,"Storage and verification of DB3 wallet account password"))}m.isMDXComponent=!0},86364:function(e,t,a){t.Z=a.p+"assets/files/formula_ecdsa-7afe4611a1112cef1cbbf5e09038ba2d.jpg"},3030:function(e,t,a){t.Z=a.p+"assets/images/formula_ecdsa-7afe4611a1112cef1cbbf5e09038ba2d.jpg"}}]);