"use strict";(self.webpackChunkneo_dev_portal=self.webpackChunkneo_dev_portal||[]).push([[1836],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return u}});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=s(n),u=r,h=d["".concat(p,".").concat(u)]||d[u]||m[u]||o;return n?a.createElement(h,i(i({ref:t},c),{},{components:n})):a.createElement(h,i({ref:t},c))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var s=2;s<o;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},92239:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return p},metadata:function(){return s},toc:function(){return c},default:function(){return d}});var a=n(87462),r=n(63366),o=(n(67294),n(3905)),i=["components"],l={},p="NEP-17",s={unversionedId:"n3/develop/write/nep17",id:"n3/develop/write/nep17",isDocsHomePage:!1,title:"NEP-17",description:"The NEP-17 proposal is a replacement of the original NEP5 proposal, which outlines a token standard for the Neo blockchain that will provide systems with a generalized interaction mechanism for tokenized Smart Contracts.",source:"@site/docs/n3/develop/write/nep17.md",sourceDirName:"n3/develop/write",slug:"/n3/develop/write/nep17",permalink:"/website/docs/n3/develop/write/nep17",editUrl:"https://github.com/neo-project/neo-dev-portal/blob/master/docs/n3/develop/write/nep17.md",tags:[],version:"current",lastUpdatedBy:"Apisit",frontMatter:{},sidebar:"docs",previous:{title:"NEP-11",permalink:"/website/docs/n3/develop/write/nep11"},next:{title:"Contract Update and Destroy",permalink:"/website/docs/n3/develop/write/update"}},c=[{value:"NEP-17 changes",id:"nep-17-changes",children:[{value:"onNEP17Payment",id:"onnep17payment",children:[]},{value:"name method",id:"name-method",children:[]},{value:"Transfer event",id:"transfer-event",children:[]},{value:"IsPayable",id:"ispayable",children:[]}]}],m={toc:c};function d(e){var t=e.components,n=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"nep-17"},"NEP-17"),(0,o.kt)("p",null,"The NEP-17 proposal is a replacement of the original NEP5 proposal, which outlines a token standard for the Neo blockchain that will provide systems with a generalized interaction mechanism for tokenized Smart Contracts. "),(0,o.kt)("p",null,"NEP17 assets are recorded in the contract storage area, through updating account balance in the storage area, to complete the transaction."),(0,o.kt)("p",null,"In the method definitions below, we provide both the definitions of the functions as they are defined in the contract as well as the invoke parameters."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"totalSupply")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n  "name": "totalSupply",\n  "parameters": [],\n  "returntype": "Integer"\n}\n')),(0,o.kt)("p",null,"Returns the total token supply deployed in the system."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"symbol")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n  "name": "symbol",\n  "parameters": [],\n  "returntype": "String"\n}\n')),(0,o.kt)("p",null,'Returns a short string symbol of the token managed in this contract. e.g. "MYT". '),(0,o.kt)("p",null,"This string MUST be valid ASCII, MUST NOT contain whitespace or control characters, SHOULD be limited to uppercase Latin alphabet (i.e. the 26 letters used in English) and SHOULD be short (3-8 characters is recommended). "),(0,o.kt)("p",null,"This method MUST always return the same value every time it is invoked."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"decimals")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n  "name": "decimals",\n  "parameters": [],\n  "returntype": "Integer"\n}\n')),(0,o.kt)("p",null,"Returns the number of decimals used by the token - e.g. ",(0,o.kt)("inlineCode",{parentName:"p"},"8"),", means to divide the token amount by ",(0,o.kt)("inlineCode",{parentName:"p"},"100,000,000")," to get its user representation."),(0,o.kt)("p",null,"This method MUST always return the same value every time it is invoked."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"balanceOf")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n  "name": "balanceOf",\n  "parameters": [\n    {\n      "name": "account",\n      "type": "Hash160"\n    }\n  ],\n  "returntype": "Integer"\n}\n')),(0,o.kt)("p",null,"Returns the token balance of the ",(0,o.kt)("inlineCode",{parentName:"p"},"account"),"."),(0,o.kt)("p",null,"The parameter ",(0,o.kt)("inlineCode",{parentName:"p"},"account")," MUST be a 20-byte address. If not, this method SHOULD ",(0,o.kt)("inlineCode",{parentName:"p"},"throw")," an exception."),(0,o.kt)("p",null,"If the ",(0,o.kt)("inlineCode",{parentName:"p"},"account")," is an unused address, this method MUST return ",(0,o.kt)("inlineCode",{parentName:"p"},"0"),"."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"transfer")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n  "name": "transfer",\n  "parameters": [\n    {\n      "name": "from",\n      "type": "Hash160"\n    },\n    {\n      "name": "to",\n      "type": "Hash160"\n    },\n    {\n      "name": "amount",\n      "type": "Integer"\n    },\n    {\n      "name": "data",\n      "type": "Any"\n    }\n  ],\n  "returntype": "Boolean"\n}\n')),(0,o.kt)("p",null,"Transfers an ",(0,o.kt)("inlineCode",{parentName:"p"},"amount")," of tokens from the ",(0,o.kt)("inlineCode",{parentName:"p"},"from")," account to the ",(0,o.kt)("inlineCode",{parentName:"p"},"to")," account. "),(0,o.kt)("p",null,"The parameters ",(0,o.kt)("inlineCode",{parentName:"p"},"from")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"to")," MUST be 20-byte addresses. If not, this method SHOULD ",(0,o.kt)("inlineCode",{parentName:"p"},"throw")," an exception.",(0,o.kt)("br",null)),(0,o.kt)("p",null,"The parameter ",(0,o.kt)("inlineCode",{parentName:"p"},"amount")," MUST be greater than or equal to ",(0,o.kt)("inlineCode",{parentName:"p"},"0"),". If not, this method SHOULD ",(0,o.kt)("inlineCode",{parentName:"p"},"throw")," an exception.",(0,o.kt)("br",null)),(0,o.kt)("p",null,"The function MUST return ",(0,o.kt)("inlineCode",{parentName:"p"},"false")," if the ",(0,o.kt)("inlineCode",{parentName:"p"},"from")," account balance does not have enough tokens to spend.",(0,o.kt)("br",null)),(0,o.kt)("p",null,"If the method succeeds, it MUST fire the ",(0,o.kt)("inlineCode",{parentName:"p"},"Transfer")," event, and MUST return ",(0,o.kt)("inlineCode",{parentName:"p"},"true"),", even if the ",(0,o.kt)("inlineCode",{parentName:"p"},"amount")," is ",(0,o.kt)("inlineCode",{parentName:"p"},"0"),", or ",(0,o.kt)("inlineCode",{parentName:"p"},"from")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"to")," are the same address.",(0,o.kt)("br",null)),(0,o.kt)("p",null,"The function SHOULD check whether the ",(0,o.kt)("inlineCode",{parentName:"p"},"from")," address equals the caller contract hash. If so, the transfer SHOULD be processed; If not, the function SHOULD use the SYSCALL ",(0,o.kt)("inlineCode",{parentName:"p"},"Neo.Runtime.CheckWitness")," to verify the transfer.",(0,o.kt)("br",null)),(0,o.kt)("p",null,"If the transfer is not processed, the function MUST return ",(0,o.kt)("inlineCode",{parentName:"p"},"false"),"."),(0,o.kt)("p",null,"If the receiver is a deployed contract, the function MUST call ",(0,o.kt)("inlineCode",{parentName:"p"},"onNEP17Payment")," method on receiver contract with the ",(0,o.kt)("inlineCode",{parentName:"p"},"data")," parameter from ",(0,o.kt)("inlineCode",{parentName:"p"},"transfer")," AFTER firing the ",(0,o.kt)("inlineCode",{parentName:"p"},"Transfer")," event. If the receiver doesn't want to receive this transfer it MUST call ",(0,o.kt)("inlineCode",{parentName:"p"},"ABORT"),". "),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Transfer Event")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n  "name": "Transfer",\n  "parameters": [\n    {\n      "name": "from",\n      "type": "Hash160"\n    },\n    {\n      "name": "to",\n      "type": "Hash160"\n    },\n    {\n      "name": "amount",\n      "type": "Integer"\n    }\n  ]\n}\n')),(0,o.kt)("p",null,"MUST trigger when tokens are transferred, including zero value transfers and self-transfers. ",(0,o.kt)("br",null)),(0,o.kt)("p",null,"A token contract which creates new tokens MUST trigger a ",(0,o.kt)("inlineCode",{parentName:"p"},"Transfer")," event with the ",(0,o.kt)("inlineCode",{parentName:"p"},"from")," address set to ",(0,o.kt)("inlineCode",{parentName:"p"},"null")," when tokens are created.",(0,o.kt)("br",null)),(0,o.kt)("p",null,"A token contract which burns tokens MUST trigger a ",(0,o.kt)("inlineCode",{parentName:"p"},"Transfer")," event with the ",(0,o.kt)("inlineCode",{parentName:"p"},"to")," address set to ",(0,o.kt)("inlineCode",{parentName:"p"},"null")," when tokens are burned."),(0,o.kt)("p",null,"NEP17 methods are as follows. For the complete code refer to ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/neo-project/examples/tree/master/csharp/NEP17"},"NEP-17 contract code"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-cs"},'using Neo;\nusing Neo.SmartContract;\nusing Neo.SmartContract.Framework;\nusing Neo.SmartContract.Framework.Native;\nusing Neo.SmartContract.Framework.Services;\nusing System;\nusing System.Numerics;\n\nnamespace Template.NEP17.CSharp\n{\n    public partial class NEP17 : SmartContract\n    {\n        public static BigInteger TotalSupply() => TotalSupplyStorage.Get();\n\n        public static BigInteger BalanceOf(UInt160 account)\n        {\n            if (!ValidateAddress(account)) throw new Exception("The parameters account SHOULD be a 20-byte non-zero address.");\n            return AssetStorage.Get(account);\n        }\n\n        public static bool Transfer(UInt160 from, UInt160 to, BigInteger amount, object data)\n        {\n            if (!ValidateAddress(from) || !ValidateAddress(to)) throw new Exception("The parameters from and to SHOULD be 20-byte non-zero addresses.");\n            if (amount <= 0) throw new Exception("The parameter amount MUST be greater than 0.");\n            if (!Runtime.CheckWitness(from) && !from.Equals(ExecutionEngine.CallingScriptHash)) throw new Exception("No authorization.");\n            if (AssetStorage.Get(from) < amount) throw new Exception("Insufficient balance.");\n            if (from == to) return true;\n\n            AssetStorage.Reduce(from, amount);\n            AssetStorage.Increase(to, amount);\n\n            OnTransfer(from, to, amount);\n\n            // Validate payable\n            if (IsDeployed(to)) Contract.Call(to, "onNEP17Payment", new object[] { from, amount, data });\n            return true;\n        }\n    }\n}\n')),(0,o.kt)("h2",{id:"nep-17-changes"},"NEP-17 changes"),(0,o.kt)("p",null,"This section summaries NEP-17 changes compared to the previous NEP-5 protocol.  "),(0,o.kt)("h3",{id:"onnep17payment"},"onNEP17Payment"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"The Transfer method should determine if the recipient is the deployed contract, and if so, call its ",(0,o.kt)("inlineCode",{parentName:"p"},"onNEP17Payment")," method.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"The FungibleToken (NeoToken, GasToken) of the native contract calls the ",(0,o.kt)("inlineCode",{parentName:"p"},"onNEP17Tokens")," method when transferring assets. The NonfungibleToken calls the ",(0,o.kt)("inlineCode",{parentName:"p"},"onNEP11Tokens")," method when transferring assets.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"The TokenSale contract should implement the ",(0,o.kt)("inlineCode",{parentName:"p"},"onNEP17Payment")," method to receive assets and modify the Manifest file to trust the received asset contract."))),(0,o.kt)("h3",{id:"name-method"},"name method"),(0,o.kt)("p",null,"The name method is moved to the manifest file, and you need to add ",(0,o.kt)("inlineCode",{parentName:"p"},'[DisplayName("Token Name")]')," when writing the contract."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-cs"},'[DisplayName("Token Name")]\n[ManifestExtra("Author", "Neo")]\n[ManifestExtra("Email", "dev@neo.org")]\n[ManifestExtra("Description", "This is a NEP17 example")]\n[SupportedStandards("NEP-17")]\npublic partial class NEP17 : SmartContract\n{\n    [DisplayName("Transfer")]\n    public static event Action<UInt160, UInt160, BigInteger> OnTransfer;\n\n    public static string Symbol() => "TokenSymbol";\n\n    public static ulong Decimals() => 8;\n    \n    //\u2026\u2026\n}\n')),(0,o.kt)("h3",{id:"transfer-event"},"Transfer event"),(0,o.kt)("p",null,"The transfer event is changed to Transfer event (first letter capitalized)."),(0,o.kt)("h3",{id:"ispayable"},"IsPayable"),(0,o.kt)("p",null,"In Neo Legacy, you should check the IsPayable checkbox when deploying contracts to receive NEP-5 assets."),(0,o.kt)("p",null,"In Neo N3.x, the payable check has been removed and the corresponding logic has been placed in the ",(0,o.kt)("inlineCode",{parentName:"p"},"onNEP17Payment")," method."),(0,o.kt)("p",null,"The ability of the contract to receive assets has been changed from a fixed constant to the code logic within the contract."))}d.isMDXComponent=!0}}]);